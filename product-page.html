<div class="container">
  <a href="#" class="back-link" id="backBtn">← Back</a>

  <div class="product-layout">
    <div class="gallery">
      <img id="mainImage" class="main-image" src="">
      <div id="thumbnails" class="thumbnails"></div>
    </div>

    <!-- ---------- PRODUCT INFO ---------- -->
<div class="product-info">
  <div id="ribbon" class="ribbon" style="display:none"></div>
  <h1 id="title">Demo Product Title</h1>
  <div class="price-container">
    <span id="price" class="price">$19.99</span>
    <span id="oldPrice" class="old-price">$29.99</span>
  </div>
  <div id="category" class="category" style="margin-bottom:10px;">Category: Digital Art</div>
  <div id="keywords" class="keywords" style="margin-bottom:20px;">Keywords: Art, Poster, Wall Decor</div>
  <div id="description" class="description">
    <p><strong>Markdown Demo:</strong> This is a <em>demo product</em> description. It includes <strong>bold</strong>, <em>italic</em>, and <u>underlined</u> text. You can also add lists:</p>
    <ul>
      <li>High resolution</li>
      <li>Easy to download</li>
      <li>Printable in various sizes</li>
    </ul>
  </div>
  
  <div class="cta">
    <div class="license-options-vertical" style="display:flex; flex-direction:column; gap:10px;">
      <label><input type="radio" name="license" value="personal" checked> Personal</label>
      <label><input type="radio" name="license" value="commercial"> Commercial</label>
      <label><input type="radio" name="license" value="extended"> Extended</label>
    </div>
    <div style="display:flex; gap:12px; margin-top:12px;">
      <button id="addToCart">Add to Cart</button>
      <button id="buyNow" style="background:#ff4500;">Buy Now</button>
    </div>
  </div>
</div>


  <div class="related-products">
    <h2>Related Products</h2>
    <div id="relatedGrid" class="related-grid"></div>
  </div>
</div>

<div class="wrapper">

  <!-- LEFT SIDE ACCORDION -->
  <div class="accordion">

    <div class="accordion-item">
      <button class="accordion-header">
        High-Resolution Digital Art Prints
        <span class="icon">+</span>
      </button>
      <div class="accordion-content">
        <p>You’ll receive high-resolution files with crisp detail, vibrant color, and easy resizing, so you can print them in any size at home or through a local or online printing service. Perfect for framing, gifts, or decorating your space.</p>
      </div>
    </div>

    <div class="accordion-item">
      <button class="accordion-header">
        Instant Download Via Email
        <span class="icon">+</span>
      </button>
      <div class="accordion-content">
        <p>Your files will be sent straight to your email after purchase for quick and easy access.</p>
      </div>
    </div>

    <div class="accordion-item">
      <button class="accordion-header">
        Easy To Print & Frame
        <span class="icon">+</span>
      </button>
      <div class="accordion-content">
        <p>Print effortlessly at home, online, or through a professional print shop. Once printed, your design is ready to frame and hang, instantly adding beauty to your space.</p>
      </div>
    </div>

    <div class="accordion-item">
      <button class="accordion-header">
        Usage License
        <span class="icon">+</span>
      </button>
      <div class="accordion-content">
        <p>For personal use only — perfect for home décor or thoughtful gifting.<br>For commercial licensing requests, contact us at info@artebarte.com.</p>
      </div>
    </div>

  </div>

  <!-- RIGHT SIDE MEDIA BOX -->
  <div class="media-box">
    <video autoplay muted loop playsinline id="randomMedia"></video>
  </div>

</div>

<div id="testimonials-placeholder"></div>
  <div id="artist_card-placeholder"></div>

  
<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
<script>
// Demo JS for Add to Cart and Buy Now
document.getElementById("addToCart").onclick = () => {
  const selectedLicense = document.querySelector('input[name="license"]:checked').value;
  alert(`Added Demo Product (${selectedLicense}) to cart!`);
};

document.getElementById("buyNow").onclick = () => {
  const selectedLicense = document.querySelector('input[name="license"]:checked').value;
  alert(`Proceeding to checkout for Demo Product (${selectedLicense})`);
};
</script>

  <script>
  fetch("Testimonials.html")
    .then(response => response.text())
    .then(html => {
      document.getElementById("testimonials-placeholder").innerHTML = html;
    })
    .catch(err => console.error("Failed to load testimonials:", err));
</script>

   <script>
  fetch("artist_card.html")
    .then(response => response.text())
    .then(html => {
      document.getElementById("artist_card-placeholder").innerHTML = html;
    })
    .catch(err => console.error("Failed to load artist_card:", err));
</script>

<script>
// ---------------- UTILITIES ----------------
function slugify(str){
  return str.toLowerCase().trim()
    .replace(/&/g,'and')
    .replace(/[^a-z0-9]+/g,'-')
    .replace(/^-+|-+$/g,'');
}

// ---------------- ELEMENTS ----------------
const titleEl = document.getElementById("title");
const priceEl = document.getElementById("price");
const oldPriceEl = document.getElementById("oldPrice");
const ribbonEl = document.getElementById("ribbon");
const descEl = document.getElementById("description");
const mainImage = document.getElementById("mainImage");
const thumbsEl = document.getElementById("thumbnails");
const relatedGrid = document.getElementById("relatedGrid");
const addToCartBtn = document.getElementById("addToCart");
const licenseInputs = document.querySelectorAll('input[name="license"]');

// ---------------- GET PRODUCT ID ----------------
const productId = new URLSearchParams(location.search).get("id");
if(!productId){
  titleEl.innerText = "Product not found";
} else {

  Papa.parse("https://hirshtom-web.github.io/ab/new_product_list.csv", {
    download:true,
    header:true,
    skipEmptyLines:true,
    complete: res => {

      // -------- FIND PRODUCT --------
      const product = res.data.find(p => slugify(p.name || "") === productId);
      if(!product){ titleEl.innerText = "Product not found"; return; }

      // -------- FILL PRODUCT INFO --------
      titleEl.innerText = product.name;
      priceEl.innerText = product.price ? "$" + product.price : "";
      if(product.discountValue && product.discountMode === "PERCENT"){
        oldPriceEl.innerText = "$" + product.price;
        const discounted = (parseFloat(product.price) * (1 - parseFloat(product.discountValue)/100)).toFixed(2);
        priceEl.innerText = "$" + discounted;
      }
      if(product.ribbon){ ribbonEl.style.display = "inline-block"; ribbonEl.innerText = product.ribbon; }
      descEl.innerHTML = product.description || "";

      // -------- IMAGES --------
      const images = (product.productImageUrl || "")
        .split(";").map(u=>u.trim()).filter(Boolean)
        .map(u=>u.includes("http") ? u : "https://static.wixstatic.com/media/"+u);
      if(images.length) mainImage.src = images[0];
      thumbsEl.innerHTML = "";
      images.forEach((src,i)=>{
        const t = document.createElement("img");
        t.src = src;
        if(i===0) t.classList.add("active");
        t.onclick = () => {
          mainImage.style.opacity = 0;
          setTimeout(()=>{ mainImage.src=src; mainImage.style.opacity=1; }, 200);
          document.querySelectorAll(".thumbnails img").forEach(img=>img.classList.remove("active"));
          t.classList.add("active");
        };
        thumbsEl.appendChild(t);
      });

      // -------- RELATED PRODUCTS --------
const related = res.data.filter(p => slugify(p.name || p.Name || "") !== productId).slice(0,4);
relatedGrid.innerHTML = "";
related.forEach(r => {
  const card = document.createElement("div"); card.className="related-card";

  // Image with fallback
  let imgSrc = (r.productImageUrl || r.ImageURL || "").split(";")[0];
  if(imgSrc && !imgSrc.includes("http")) imgSrc = "https://static.wixstatic.com/media/" + imgSrc;
  const img = document.createElement("img");
  img.src = imgSrc || "https://via.placeholder.com/300";

  const h4 = document.createElement("h4"); h4.innerText = r.name || r.Name || "Unnamed";
  const pEl = document.createElement("div"); pEl.className="price"; pEl.innerText = r.price ? "$" + r.price : "$1";

  card.appendChild(img); card.appendChild(h4); card.appendChild(pEl);
  card.onclick = () => location.href=`product-page.html?id=${slugify(r.name || r.Name || "")}`;

  relatedGrid.appendChild(card);
});


      // -------- ADD TO CART --------
      addToCartBtn.onclick = () => {
        const selectedLicense = document.querySelector('input[name="license"]:checked').value;
        alert(`Added ${product.name} (${selectedLicense}) to cart!`);
        // Real cart logic can go here
      };
    }
  });
}

// ---------------- BACK BUTTON ----------------
document.getElementById("backBtn").onclick = e => {
  e.preventDefault(); 
  history.length>1 ? history.back() : location.href="index.html";
};

// ---------------- ACCORDION LOGIC ----------------
const accordionItems = document.querySelectorAll('.accordion-item');
accordionItems.forEach(item => {
  const header = item.querySelector('.accordion-header');
  header.addEventListener('click', () => {

    accordionItems.forEach(i => {
      if(i !== item){
        i.classList.remove('active');
        i.querySelector('.accordion-content').style.maxHeight = null;
      }
    });

    item.classList.toggle('active');
    const content = item.querySelector('.accordion-content');
    content.style.maxHeight = item.classList.contains('active')
      ? content.scrollHeight + "px"
      : null;
  });
});

// ---------------- RANDOM MEDIA ----------------
const mediaList = [
  "https://video.wixstatic.com/video/1799ca_8428cdd03a514d8fa35248436418e881/1080p/mp4/file.mp4",
  "https://video.wixstatic.com/video/1799ca_4a4a7105ce284ce5928b811120fef2fc/1080p/mp4/file.mp4",
  "https://video.wixstatic.com/video/1799ca_9ac7f684c40e4b1db1cb7d8f644c1d77/1080p/mp4/file.mp4"
];

document.getElementById("randomMedia").src = mediaList[Math.floor(Math.random() * mediaList.length)];
</script>

</body>
</html>

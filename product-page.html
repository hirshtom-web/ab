<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Product Page</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
/* ===============================
   RESET & BODY
================================ */
* { box-sizing: border-box; margin: 0; padding: 0; }
body { font-family: 'Poppins', sans-serif; color: #111; background: #fff; margin: 0; }
.container { max-width: 100%; padding: 0 20px; margin: 0 auto; }

/* ===============================
   FULL WIDTH SECTION STYLING
================================ */
section { width: 100%; padding: 40px 0; }
section h2 { font-size: 28px; margin-bottom: 20px; text-align: center; }

/* ===============================
   PRODUCT INFO SECTION
================================ */
.product-info-section {
  display: flex;
  flex-wrap: wrap;
  gap: 30px;
  align-items: flex-start;
  justify-content: center;
}

.product-gallery {
  flex: 1 1 400px;
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.product-gallery img {
  width: 100%;
  border-radius: 12px;
  object-fit: cover;
}

.product-thumbnails {
  display: flex;
  gap: 10px;
}

.product-thumbnails img {
  width: 72px;
  height: 72px;
  object-fit: cover;
  border-radius: 8px;
  cursor: pointer;
  opacity: 0.6;
  border: 2px solid transparent;
  transition: 0.2s;
}

.product-thumbnails img.active {
  opacity: 1;
  border-color: #111;
}

.product-details {
  flex: 1 1 400px;
  display: flex;
  flex-direction: column;
  gap: 15px;
}

.product-details h1 { font-size: 32px; }
.product-price { font-size: 24px; font-weight: 600; }
.product-old-price { font-size: 18px; text-decoration: line-through; color: #999; }
.product-description { font-size: 15px; line-height: 1.6; color: #444; }

.cta-buttons { display: flex; gap: 12px; margin-top: 20px; }
.cta-buttons button {
  flex: 1;
  padding: 14px 26px;
  border-radius: 999px;
  border: none;
  font-size: 14px;
  cursor: pointer;
}

#addToCart { background: #111; color: #fff; }
#buyNow { background: #ff4500; color: #fff; }

.license-options { display: flex; gap: 10px; margin-top: 10px; }
.license-options label { display: flex; align-items: center; gap: 6px; cursor: pointer; }

/* ===============================
   ACCORDION / DETAILS SECTION
================================ */
.accordion {
  display: flex;
  flex-direction: column;
  gap: 12px;
  max-width: 800px;
  margin: 0 auto;
}

.accordion-item {
  background: #F7F5ED;
  border-radius: 12px;
  overflow: hidden;
  border: 1px solid #f0ede4;
}

.accordion-header {
  padding: 0 20px;
  height: 60px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  font-weight: 500;
  cursor: pointer;
  border: none;
  background: transparent;
}

.accordion-content {
  max-height: 0;
  overflow: hidden;
  padding: 0 20px;
  transition: max-height 0.35s ease, padding 0.35s ease;
}

.accordion-item.active .accordion-content {
  padding: 12px 20px 20px;
}

/* ===============================
   RELATED ITEMS SECTION
================================ */
.related-items-section {
  overflow: hidden;
  position: relative;
}

.related-slider-wrapper {
  display: flex;
  align-items: center;
}

.related-grid {
  display: flex;
  gap: 20px;
  overflow-x: auto;
  scroll-behavior: smooth;
  padding-bottom: 10px;
}

.related-grid::-webkit-scrollbar { display: none; }

.related-card {
  flex: 0 0 auto;
  width: 180px;
  border: 1px solid #eee;
  border-radius: 12px;
  padding: 12px;
  text-align: center;
  background: #fff;
  transition: transform 0.2s, box-shadow 0.2s;
  cursor: pointer;
}

.related-card:hover {
  transform: scale(1.05);
  box-shadow: 0 8px 20px rgba(0,0,0,0.1);
}

.related-card img {
  width: 100%;
  aspect-ratio: 1/1;
  object-fit: cover;
  border-radius: 12px;
}

.slider-btn {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  border: none;
  background: rgba(0,0,0,0.5);
  color: #fff;
  font-size: 24px;
  width: 40px;
  height: 60px;
  cursor: pointer;
  z-index: 2;
  border-radius: 6px;
}

.slider-btn.prev { left: 0; }
.slider-btn.next { right: 0; }

/* ===============================
   ARTIST CARD & TESTIMONIALS
================================ */
.artist-card-section, .testimonials-section {
  max-width: 1200px;
  margin: 0 auto;
}

@media (max-width: 768px) {
  .product-info-section { flex-direction: column; }
  .related-card { width: 140px; }
  .slider-btn { width: 32px; height: 48px; font-size: 20px; }
}

@media (max-width: 480px) {
  .related-card { width: 120px; }
  section h2 { font-size: 20px; }
}
</style>
</head>
<body>

<!-- ===============================
     PRODUCT INFO SECTION
================================ -->
<section class="product-info-section">
  <div class="product-gallery">
    <img id="mainImage" src="">
    <div class="product-thumbnails" id="thumbnails"></div>
  </div>
  <div class="product-details">
    <h1 id="title">Demo Product</h1>
    <div class="product-price" id="price">$19.99</div>
    <div class="product-old-price" id="oldPrice">$29.99</div>
    <div class="product-description" id="description">
      Demo description here.
    </div>
    <div class="license-options">
      <label><input type="radio" name="license" value="personal" checked> Personal</label>
      <label><input type="radio" name="license" value="commercial"> Commercial</label>
      <label><input type="radio" name="license" value="extended"> Extended</label>
    </div>
    <div class="cta-buttons">
      <button id="addToCart">Add to Cart</button>
      <button id="buyNow">Buy Now</button>
    </div>
  </div>
</section>

<!-- ===============================
     ACCORDION / DETAILS SECTION
================================ -->
<section class="accordion-section">
  <h2>Product Details Section</h2>
  <div class="accordion">
    <div class="accordion-item">
      <button class="accordion-header">High-Resolution Digital Art Prints</button>
      <div class="accordion-content">
        <p>High-resolution files with crisp details for printing.</p>
      </div>
    </div>
    <div class="accordion-item">
      <button class="accordion-header">Instant Download Via Email</button>
      <div class="accordion-content">
        <p>Files sent directly to your email after purchase.</p>
      </div>
    </div>
    <div class="accordion-item">
      <button class="accordion-header">Usage License</button>
      <div class="accordion-content">
        <p>For personal use only. Contact us for commercial licenses.</p>
      </div>
    </div>
  </div>
</section>

<!-- ===============================
     RELATED ITEMS SECTION
================================ -->
<section class="related-items-section">
  <h2>Related Items Section</h2>
  <div class="related-slider-wrapper">
    <button class="slider-btn prev">‹</button>
    <div id="relatedGrid" class="related-grid"></div>
    <button class="slider-btn next">›</button>
  </div>
</section>

<!-- ===============================
     ARTIST CARD SECTION
================================ -->
<section class="artist-card-section">
  <h2>Artist Card Section</h2>
  <div id="artist-card-placeholder"></div>
</section>

<!-- ===============================
     TESTIMONIALS SECTION
================================ -->
<section class="testimonials-section">
  <h2>Testimonials Section</h2>
  <div id="testimonials-placeholder"></div>
</section>

<!-- ===============================
     SCRIPTS
================================ -->
<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
<script>
// ---------------- ELEMENTS ----------------
const titleEl = document.getElementById("title");
const priceEl = document.getElementById("price");
const oldPriceEl = document.getElementById("oldPrice");
const descEl = document.getElementById("description");
const mainImage = document.getElementById("mainImage");
const thumbsEl = document.getElementById("thumbnails");
const relatedGrid = document.getElementById("relatedGrid");
const addToCartBtn = document.getElementById("addToCart");

// ---------------- PRODUCT DATA ----------------

// ---------------- PRODUCT DATA ----------------
const productId = new URLSearchParams(location.search).get("id") || "demo";

fetch("https://hirshtom-web.github.io/ab/product_catalog.csv")
  .then(response => {
    if (!response.ok) throw new Error("CSV file not found or CORS blocked");
    return response.text();
  })
  .then(csvText => {
    Papa.parse(csvText, {
      header: true,
      skipEmptyLines: true,
      complete: function(res) {
        console.log("CSV Parsed:", res.data); // debug

        const product = res.data.find(p => (p.name||"").toLowerCase() === productId);
        if(!product) {
          console.warn("Product not found in CSV!");
          return;
        }

        // set text
        titleEl.innerText = product.name;
        priceEl.innerText = "$" + product.price;
        oldPriceEl.innerText = product.discountValue ? "$" + product.discountValue : "";
        descEl.innerHTML = product.description || "";

        // images
        const images = (product.productImageUrl||"").split(";").filter(Boolean);
        if(images.length) mainImage.src = images[0];

        thumbsEl.innerHTML = "";
        images.forEach((src, i) => {
          const t = document.createElement("img");
          t.src = src;
          if(i === 0) t.classList.add("active");
          t.onclick = () => {
            mainImage.src = src;
            thumbsEl.querySelectorAll("img").forEach(img => img.classList.remove("active"));
            t.classList.add("active");
          };
          thumbsEl.appendChild(t);
        });

        // related items
        const related = res.data.filter(p => p.name !== product.name).slice(0, 10);
        related.forEach(r => {
          const card = document.createElement("div");
          card.className = "related-card";
          const img = document.createElement("img");
          img.src = (r.productImageUrl||"").split(";")[0] || "https://via.placeholder.com/300";
          const h4 = document.createElement("h4");
          h4.innerText = r.name || "Unnamed";
          card.appendChild(img);
          card.appendChild(h4);
          card.onclick = () => location.href = `product-page.html?id=${(r.name||"").toLowerCase()}`;
          relatedGrid.appendChild(card);
        });
      }
    });
  })
  .catch(err => {
    console.error("CSV load error:", err);
  });


// ---------------- ADD TO CART ----------------
addToCartBtn.onclick = ()=>{
  const selectedLicense = document.querySelector('input[name="license"]:checked').value;
  alert(`Added ${titleEl.innerText} (${selectedLicense}) to cart!`);
};

// ---------------- ACCORDION ----------------
document.querySelectorAll(".accordion-header").forEach(header=>{
  header.onclick = ()=>{
    const item = header.parentElement;
    item.classList.toggle("active");
    const content = header.nextElementSibling;
    if(item.classList.contains("active")) content.style.maxHeight = content.scrollHeight + "px";
    else content.style.maxHeight = null;
  };
});

// ---------------- RELATED SLIDER BUTTONS ----------------
const slider = document.getElementById("relatedGrid");
document.querySelector(".slider-btn.next").onclick = () => slider.scrollBy({ left: 240, behavior: 'smooth' });
document.querySelector(".slider-btn.prev").onclick = () => slider.scrollBy({ left: -240, behavior: 'smooth' });

// ---------------- LOAD EXTERNAL SECTIONS ----------------
fetch("artist-card.html").then(r=>r.text()).then(html=>document.getElementById("artist-card-placeholder").innerHTML=html);
fetch("testimonials.html").then(r=>r.text()).then(html=>document.getElementById("testimonials-placeholder").innerHTML=html);
</script>
</body>
</html>

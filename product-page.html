<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Product</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

<style>
*{box-sizing:border-box}
body{
  margin:0;
  font-family:'Poppins',sans-serif;
  background:#fff;
  color:#111;
}

.container{
  max-width:1200px;
  margin:0 auto;
  padding:24px;
}

.back-link{
  display:inline-block;
  margin-bottom:20px;
  text-decoration:none;
  color:#111;
  font-weight:500;
}

/* --- Layout --- */
.product-layout{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:40px;
}

@media(max-width:900px){
  .product-layout{
    grid-template-columns:1fr;
  }
}

/* --- Images --- */
.gallery{
  display:flex;
  flex-direction:column;
  gap:14px;
}

.main-image{
  width:100%;
  aspect-ratio:1/1;
  border-radius:18px;
  object-fit:cover;
  background:#f3f3f3;
}

.thumbnails{
  display:flex;
  gap:10px;
}

.thumbnails img{
  width:72px;
  height:72px;
  object-fit:cover;
  border-radius:12px;
  cursor:pointer;
  opacity:.6;
  border:2px solid transparent;
}

.thumbnails img.active{
  opacity:1;
  border-color:#111;
}

/* --- Info --- */
.product-info h1{
  font-size:32px;
  margin:0 0 10px;
}

.price{
  font-size:24px;
  font-weight:600;
  margin:10px 0 20px;
}

.ribbon{
  display:inline-block;
  background:#111;
  color:#fff;
  padding:6px 12px;
  border-radius:999px;
  font-size:12px;
  margin-bottom:12px;
}

.description{
  font-size:15px;
  line-height:1.6;
  color:#444;
  margin-top:20px;
}

/* --- CTA --- */
.cta{
  margin-top:30px;
}

.cta button{
  padding:14px 26px;
  border-radius:999px;
  border:none;
  background:#111;
  color:#fff;
  font-size:14px;
  cursor:pointer;
}
</style>
</head>

<body>

<div class="container">
  <a href="#" class="back-link" id="backBtn">‚Üê Back</a>

  <div class="product-layout">
    <div class="gallery">
      <img id="mainImage" class="main-image" src="">
      <div id="thumbnails" class="thumbnails"></div>
    </div>

    <div class="product-info">
      <div id="ribbon" class="ribbon" style="display:none"></div>
      <h1 id="title">Loading...</h1>
      <div id="price" class="price"></div>
      <div id="description" class="description"></div>

      <div class="cta">
        <button>Add to cart</button>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
<script>
const titleEl = document.getElementById("title");
const priceEl = document.getElementById("price");
const ribbonEl = document.getElementById("ribbon");
const descEl = document.getElementById("description");
const mainImage = document.getElementById("mainImage");
const thumbsEl = document.getElementById("thumbnails");

/* --- Get ID --- */
const productId = new URLSearchParams(location.search).get("id");

if(!productId){
  titleEl.innerText = "Product not found";
} else {

  Papa.parse("https://hirshtom-web.github.io/ab/new_product_list.csv", {
    download:true,
    header:true,
    skipEmptyLines:true,
    complete: res => {

      const product = res.data.find(p => p.id?.toString() === productId);

      if(!product){
        titleEl.innerText = "Product not found";
        return;
      }

      /* --- Fill content --- */
      titleEl.innerText = product.name;
      priceEl.innerText = product.price ? "$" + product.price : "";

      if(product.ribbon){
        ribbonEl.style.display = "inline-block";
        ribbonEl.innerText = product.ribbon;
      }

      descEl.innerHTML = product.description || "";

      /* --- Images --- */
      const images = (product.productImageUrl || "")
        .split(";")
        .map(u => u.trim())
        .filter(Boolean)
        .map(u => u.includes("http") ? u : "https://static.wixstatic.com/media/" + u);

      if(images.length){
        mainImage.src = images[0];
      }

      thumbsEl.innerHTML = "";
      images.forEach((src, i) => {
        const t = document.createElement("img");
        t.src = src;
        if(i === 0) t.classList.add("active");

        t.onclick = () => {
          mainImage.src = src;
          document.querySelectorAll(".thumbnails img")
            .forEach(img => img.classList.remove("active"));
          t.classList.add("active");
        };

        thumbsEl.appendChild(t);
      });
    }
  });
}

/* --- Back --- */
document.getElementById("backBtn").onclick = e => {
  e.preventDefault();
  history.length > 1 ? history.back() : location.href = "index.html";
};
</script>

</body>
</html>

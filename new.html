<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Manual Product Manager</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

<style>
body { font-family: 'Poppins', sans-serif; margin:0; padding:20px; background:#f9f9f9; color:#111; }
h1 { text-align:center; }
form { max-width:800px; margin:auto; background:#fff; padding:20px; border-radius:10px; margin-bottom:40px; }
form input, form select, form textarea { width:100%; margin-bottom:10px; padding:8px; border-radius:5px; border:1px solid #ccc; }
form label { font-weight:500; margin-top:10px; display:block; }
button { padding:10px 15px; border:none; border-radius:5px; cursor:pointer; background:#111; color:#fff; margin-top:10px; }

#productGrid { display:grid; gap:20px; grid-template-columns:repeat(3,1fr); max-width:95%; margin:auto; }
.product-card { position:relative; background:#fff; border-radius:16px; overflow:hidden; padding-bottom:50px; cursor:grab; }
.img-wrapper { width:100%; aspect-ratio:1/1; overflow:hidden; }
.img-wrapper img { width:100%; height:100%; object-fit:cover; }
.top-label { position:absolute; top:12px; left:12px; background:#ff5e5e; color:#fff; padding:4px 8px; font-size:10px; border-radius:12px; }
.top-bubbles { position:absolute; top:12px; right:12px; display:flex; gap:6px; }
.top-bubbles div { padding:3px 8px; background:rgba(255,255,255,0.85); border-radius:10px; border:1px solid #eee; font-size:9px; }
.product-info { padding:10px; }
.product-info h3 { margin:0; font-size:14px; font-weight:500; }
.price { font-weight:600; color:#111; font-size:13px; }
.dragging { opacity:0.5; }
</style>
</head>
<body>

<h1>Manual Product Manager</h1>

<form id="productForm">

  <label>Field Type</label>
  <input type="text" name="fieldType">

  <label>Name</label>
  <input type="text" name="name" required>

  <label>Product Image URL</label>
  <input type="text" name="productImageUrl">

  <label>SKU</label>
  <input type="text" name="sku">

  <label>Ribbon</label>
  <input type="text" name="ribbon">

  <label>Price</label>
  <input type="number" name="price" required>

  <label>Visible</label>
  <select name="visible">
    <option value="true">Visible</option>
    <option value="false">Hidden</option>
  </select>

  <label>Discount Mode</label>
  <input type="text" name="discountMode">

  <label>Discount Value</label>
  <input type="number" name="discountValue">

  <label>Cost</label>
  <input type="number" name="cost">

  <label>Digital File</label>
  <input type="text" name="digitalFile">

  <label>Collection</label>
  <input type="text" name="collection">

  <label>Category</label>
  <input type="text" name="category">

  <label>Color</label>
  <input type="text" name="color">

  <!-- Original fields -->
  <label>Surcharge</label>
  <input type="number" name="surcharge">

  <label>Keyword</label>
  <input type="text" name="keyword">

  <label>Feel</label>
  <input type="text" name="feel">

  <label>Bundle</label>
  <input type="text" name="bundle">

  <label>Images (multiple allowed)</label>
  <input type="file" name="images" accept="image/*" multiple>

  <button type="submit">Add Product</button>
  
</form>

<h2 style="text-align:center;">Product Grid (Drag to reorder)</h2>
<div id="productGrid"></div>

<script>
let products = [];

// Render product cards
function renderGrid() {
  const grid = document.getElementById("productGrid");
  grid.innerHTML = "";

  products.forEach((p, index) => {
    const card = document.createElement("div");
    card.className = "product-card";
    card.draggable = true;
    card.dataset.index = index;

    if (p.ribbon) card.innerHTML += `<div class="top-label">${p.ribbon}</div>`;

    let bubbles = "";
    if (p.keyword) bubbles += `<div>${p.keyword}</div>`;
    if (p.feel) bubbles += `<div>${p.feel}</div>`;
    if (bubbles) card.innerHTML += `<div class="top-bubbles">${bubbles}</div>`;

    let imgs = "";
    p.images.forEach(img => imgs += `<div class="img-wrapper"><img src="${img}"></div>`);
    card.innerHTML += imgs;

    card.innerHTML += `
      <div class="product-info">
        <h3>${p.name}</h3>
        <div class="price">$${p.price}</div>
      </div>`;

    grid.appendChild(card);
  });

  enableDragAndDrop();
}

// Handle form submit
document.getElementById("productForm").addEventListener("submit", async function(e) {
  e.preventDefault();

  const form = e.target;
  const formData = new FormData(form);
  const images = [];

  for (let file of formData.getAll("images")) {
    images.push(URL.createObjectURL(file));
  }

  const product = {
    fieldType: formData.get("fieldType"),
    name: formData.get("name"),
    productImageUrl: formData.get("productImageUrl"),
    sku: formData.get("sku"),
    ribbon: formData.get("ribbon"),
    price: Number(formData.get("price")),
    visible: formData.get("visible") === "true",
    discountMode: formData.get("discountMode"),
    discountValue: Number(formData.get("discountValue")),
    cost: Number(formData.get("cost")),
    digitalFile: formData.get("digitalFile"),
    collection: formData.get("collection"),
    category: formData.get("category"),
    color: formData.get("color"),

    // original
    surcharge: formData.get("surcharge"),
    keyword: formData.get("keyword"),
    feel: formData.get("feel"),
    bundle: formData.get("bundle"),
    images: images
  };

  products.push(product);
  form.reset();
  renderGrid();
});

// Drag and Drop Reordering
function enableDragAndDrop() {
  const cards = document.querySelectorAll(".product-card");
  let draggedIndex = null;

  cards.forEach(card => {
    card.addEventListener("dragstart", e => draggedIndex = card.dataset.index);
    card.addEventListener("dragover", e => e.preventDefault());
    card.addEventListener("drop", e => {
      const targetIndex = card.dataset.index;
      const temp = products[draggedIndex];
      products.splice(draggedIndex, 1);
      products.splice(targetIndex, 0, temp);
      renderGrid();
    });
  });
}
</script>

</body>
</html>
